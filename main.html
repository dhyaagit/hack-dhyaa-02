<!DOCTYPE html>
<html lang="fr" class="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Prayer Hub</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Amiri:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
  <style>
    :root {
      --background: 0 0% 100%;
      --foreground: 222.2 84% 4.9%;
      --card: 0 0% 100%;
      --card-foreground: 222.2 84% 4.9%;
      --popover: 0 0% 100%;
      --popover-foreground: 222.2 84% 4.9%;
      --primary: 221.2 83.2% 53.3%;
      --primary-foreground: 210 40% 98%;
      --secondary: 210 40% 96.1%;
      --secondary-foreground: 222.2 47.4% 11.2%;
      --muted: 210 40% 96.1%;
      --muted-foreground: 215.4 16.3% 46.9%;
      --accent: 210 40% 96.1%;
      --accent-foreground: 222.2 47.4% 11.2%;
      --destructive: 0 84.2% 60.2%;
      --destructive-foreground: 210 40% 98%;
      --border: 214.3 31.8% 91.4%;
      --input: 214.3 31.8% 91.4%;
      --ring: 221.2 83.2% 53.3%;
      --radius: 0.5rem;
      
      /* Computed colors */
      --primary-color: hsl(221.2, 83.2%, 53.3%);
      --primary-hover: hsl(221.2, 83.2%, 45%);
      --primary-light: hsla(221.2, 83.2%, 53.3%, 0.1);
      --primary-border: hsla(221.2, 83.2%, 53.3%, 0.2);
      --text-color: hsl(222.2, 84%, 4.9%);
      --text-muted: hsl(215.4, 16.3%, 46.9%);
      --border-color: hsl(214.3, 31.8%, 91.4%);
      --card-bg: hsla(0, 0%, 100%, 0.3);
      --body-bg: linear-gradient(to bottom, hsl(214, 100%, 97%), hsl(0, 0%, 100%));
      --navbar-bg: hsla(0, 0%, 100%, 0.7);
      --suggestion-hover: hsl(210, 40%, 98%);
      --prayer-item-hover: hsla(210, 40%, 98%, 0.5);
      --islamic-date-bg: white;
      --tab-active-bg: white;
      --tab-hover-bg: hsla(210, 40%, 98%, 0.8);
    }
    
    html.dark {
      --background: 222.2 84% 4.9%;
      --foreground: 210 40% 98%;
      --card: 222.2 84% 4.9%;
      --card-foreground: 210 40% 98%;
      --popover: 222.2 84% 4.9%;
      --popover-foreground: 210 40% 98%;
      --primary: 217.2 91.2% 59.8%;
      --primary-foreground: 222.2 47.4% 11.2%;
      --secondary: 217.2 32.6% 17.5%;
      --secondary-foreground: 210 40% 98%;
      --muted: 217.2 32.6% 17.5%;
      --muted-foreground: 215 20.2% 65.1%;
      --accent: 217.2 32.6% 17.5%;
      --accent-foreground: 210 40% 98%;
      --destructive: 0 62.8% 30.6%;
      --destructive-foreground: 210 40% 98%;
      --border: 217.2 32.6% 17.5%;
      --input: 217.2 32.6% 17.5%;
      --ring: 224.3 76.3% 48%;
      
      /* Computed colors */
      --primary-color: hsl(217.2, 91.2%, 59.8%);
      --primary-hover: hsl(217.2, 91.2%, 65%);
      --primary-light: hsla(217.2, 91.2%, 59.8%, 0.2);
      --primary-border: hsla(217.2, 91.2%, 59.8%, 0.3);
      --text-color: hsl(210, 40%, 98%);
      --text-muted: hsl(215, 20.2%, 65.1%);
      --border-color: hsl(217.2, 32.6%, 17.5%);
      --card-bg: hsla(222.2, 84%, 4.9%, 0.4);
      --body-bg: linear-gradient(to bottom, hsl(222.2, 47.4%, 11.2%), hsl(217.2, 32.6%, 17.5%));
      --navbar-bg: hsla(222.2, 84%, 4.9%, 0.8);
      --suggestion-hover: hsl(217.2, 32.6%, 17.5%);
      --prayer-item-hover: hsla(217.2, 32.6%, 17.5%, 0.5);
      --islamic-date-bg: hsl(217.2, 32.6%, 17.5%);
      --tab-active-bg: hsl(217.2, 32.6%, 17.5%);
      --tab-hover-bg: hsla(217.2, 32.6%, 17.5%, 0.8);
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      border-color: var(--border-color);
    }
    
    body {
      font-family: 'Inter', sans-serif;
      background: var(--body-bg);
      color: var(--text-color);
      min-height: 100vh;
      transition: background 0.3s, color 0.3s;
    }
    
    .container {
      max-width: 1024px;
      margin: 0 auto;
      padding: 2rem 1rem;
    }
    
    /* Update the navbar styling to match the screenshots */
    .navbar {
      background-color: white;
      backdrop-filter: none;
      border-bottom: 1px solid #e5e7eb;
      position: sticky;
      top: 0;
      z-index: 40;
      transition: background-color 0.3s, border-color 0.3s;
    }

    html.dark .navbar {
      background-color: #1e293b;
      border-bottom: 1px solid #334155;
    }

    .navbar-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      max-width: 1024px;
      margin: 0 auto;
      padding: 0 1rem;
      height: 4rem;
    }

    .logo {
      font-weight: bold;
      font-size: 1.25rem;
      color: #2563eb;
      text-decoration: none;
    }

    html.dark .logo {
      color: #3b82f6;
    }

    .nav-links {
      display: flex;
      align-items: center;
      gap: 1.5rem;
    }

    .nav-link {
      color: #64748b;
      text-decoration: none;
      font-weight: 500;
      transition: color 0.2s;
    }

    .nav-link:hover, .nav-link.active {
      color: #2563eb;
    }

    html.dark .nav-link:hover, 
    html.dark .nav-link.active {
      color: #3b82f6;
    }
    
    .theme-toggle {
      background: none;
      border: none;
      cursor: pointer;
      padding: 0.5rem;
      color: var(--text-color);
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 0.5rem;
      margin-left: 1rem;
    }
    
    .theme-toggle:hover {
      background-color: var(--primary-light);
    }
    
    .header {
      text-align: center;
      margin-bottom: 2rem;
    }
    
    .header h1 {
      font-size: 2.5rem;
      font-weight: bold;
      margin-bottom: 0.5rem;
      letter-spacing: -0.025em;
    }
    
    .header p {
      color: var(--text-muted);
      font-size: 1.125rem;
    }
    
    .location-badge {
      display: inline-flex;
      align-items: center;
      margin-top: 0.5rem;
      padding: 0.25rem 0.75rem;
      background-color: var(--primary-light);
      color: var(--primary-color);
      border-radius: 9999px;
      font-size: 0.875rem;
      transition: background-color 0.3s;
    }
    
    .location-badge svg {
      margin-right: 0.25rem;
    }
    
    .date-time {
      text-align: center;
      margin-bottom: 2rem;
    }
    
    .date-time .date {
      font-size: 1.875rem;
      font-weight: bold;
      margin-bottom: 0.5rem;
      background-clip: text;
      -webkit-background-clip: text;
      color: transparent;
      background-image: linear-gradient(to right, var(--primary-color), var(--primary-hover));
    }
    
    .date-time .time {
      font-size: 2.5rem;
      font-weight: 600;
      font-family: monospace;
      color: var(--text-muted);
    }
    
    .date-picker-container {
      display: flex;
      justify-content: center;
      margin-bottom: 2rem;
    }
    
    .date-picker-button {
      display: flex;
      align-items: center;
      padding: 0.5rem 1rem;
      background: transparent;
      border: 1px solid var(--border-color);
      border-radius: var(--radius);
      color: var(--text-color);
      font-size: 0.875rem;
      cursor: pointer;
      width: 240px;
      text-align: left;
      transition: border-color 0.2s, box-shadow 0.2s;
    }
    
    .date-picker-button:hover {
      border-color: var(--primary-color);
    }
    
    .date-picker-button:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 2px var(--primary-light);
    }
    
    .date-picker-button svg {
      margin-right: 0.5rem;
    }
    
    .loading {
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 3rem 0;
      color: var(--primary-color);
    }
    
    .loading svg {
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      from {
        transform: rotate(0deg);
      }
      to {
        transform: rotate(360deg);
      }
    }
    
    .grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 1.5rem;
    }
    
    @media (min-width: 768px) {
      .grid {
        grid-template-columns: 1fr 1fr;
      }
    }
    
    .card {
      background-color: var(--card-bg);
      backdrop-filter: blur(8px);
      border: 1px solid var(--border-color);
      border-radius: 1rem;
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      animation: slideIn 0.3s ease-out;
      transition: background-color 0.3s, border-color 0.3s;
      overflow: hidden;
    }
    
    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .card-header {
      padding: 1.5rem 1.5rem 0.75rem;
    }
    
    .card-title {
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.25rem;
      font-weight: bold;
    }
    
    .card-title svg {
      margin-right: 0.5rem;
      color: var(--primary-color);
    }
    
    .card-content {
      padding: 0.75rem 1.5rem 1.5rem;
    }
    
    .prayer-list {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }
    
    .prayer-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.75rem;
      border-radius: 0.5rem;
      transition: background-color 0.2s;
    }
    
    .prayer-item:hover {
      background-color: var(--prayer-item-hover);
    }
    
    .prayer-item.next {
      background-color: var(--primary-light);
      border: 1px solid var(--primary-border);
    }
    
    .prayer-name {
      display: flex;
      flex-direction: column;
    }
    
    .prayer-name-en {
      font-weight: 500;
    }
    
    .prayer-name-ar {
      font-family: 'Amiri', serif;
      direction: rtl;
      font-size: 0.875rem;
      color: var(--text-muted);
    }
    
    .prayer-time {
      font-size: 1.125rem;
      font-weight: bold;
    }
    
    .prayer-item.next .prayer-time {
      color: var(--primary-color);
    }
    
    .islamic-date {
      display: flex;
      justify-content: center;
      align-items: center;
      background-color: var(--islamic-date-bg);
      border-radius: 0.5rem;
      padding: 0.75rem;
      box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
      margin-bottom: 1rem;
      max-width: 32rem;
      margin-left: auto;
      margin-right: auto;
    }
    
    .islamic-date svg {
      margin-right: 0.5rem;
      color: var(--primary-color);
    }
    
    .islamic-date-divider {
      margin: 0 0.5rem;
      color: var(--text-muted);
    }
    
    .error-message {
      text-align: center;
      padding: 1.5rem;
      background-color: rgba(254, 226, 226, 0.5);
      border-radius: 0.75rem;
      color: rgb(185, 28, 28);
      margin-bottom: 2rem;
      border: 1px solid rgba(220, 38, 38, 0.3);
      animation: fadeIn 0.3s ease-out;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    html.dark .error-message {
      background-color: rgba(185, 28, 28, 0.2);
      color: rgb(254, 202, 202);
      border: 1px solid rgba(220, 38, 38, 0.3);
    }
    
    .section-title {
      text-align: center;
      font-size: 1.5rem;
      font-weight: 600;
      margin-bottom: 1.5rem;
    }
    
    /* Flatpickr customization */
    .flatpickr-calendar {
      background: var(--card-bg);
      border-color: var(--border-color);
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
    }
    
    .flatpickr-day {
      color: var(--text-color);
    }
    
    .flatpickr-day.selected {
      background: var(--primary-color);
      border-color: var(--primary-color);
    }
    
    .flatpickr-day:hover {
      background: var(--primary-light);
    }
    
    .flatpickr-months .flatpickr-month,
    .flatpickr-current-month .flatpickr-monthDropdown-months,
    .flatpickr-months .flatpickr-prev-month, 
    .flatpickr-months .flatpickr-next-month {
      color: var(--text-color);
      fill: var(--text-color);
    }
    
    .flatpickr-weekday {
      color: var(--text-muted);
    }
    
    .flatpickr-day.flatpickr-disabled, 
    .flatpickr-day.flatpickr-disabled:hover {
      color: var(--text-muted);
    }
    
    .arabic-text {
      font-family: 'Amiri', serif;
      direction: rtl;
    }
    
    /* Hadiths styles */
    .page-container {
      display: none;
    }
    
    .page-container.active {
      display: block;
    }
    
    /* Update the hadiths page styling */
    .hadiths-header {
      text-align: center;
      margin-bottom: 2rem;
      padding-top: 1rem;
    }

    .hadiths-header h1 {
      font-size: 2.5rem;
      font-weight: bold;
      margin-bottom: 0.5rem;
      color: #111827;
    }

    html.dark .hadiths-header h1 {
      color: #f8fafc;
    }

    .hadiths-header p {
      color: #64748b;
      font-size: 1.125rem;
    }
    
    /* Update the tabs styling to match the screenshots */
    .tabs {
      display: flex;
      justify-content: center;
      gap: 1rem;
      margin-bottom: 2rem;
      flex-wrap: wrap;
    }

    .tab {
      padding: 0.75rem 1.5rem;
      border-radius: 0.5rem;
      font-weight: 500;
      cursor: pointer;
      transition: background-color 0.2s, color 0.2s;
      background-color: transparent;
      color: #64748b;
      border: none;
    }

    .tab:hover {
      background-color: rgba(241, 245, 249, 0.8);
    }

    .tab.active {
      background-color: white;
      color: #2563eb;
      box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
    }

    html.dark .tab:hover {
      background-color: rgba(30, 41, 59, 0.8);
    }

    html.dark .tab.active {
      background-color: #1e293b;
      color: #3b82f6;
    }
    
    /* Update the hadith card styling */
    .hadith-card {
      background-color: white;
      border: 1px solid #e5e7eb;
      border-radius: 1rem;
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      padding: 2rem;
      margin-bottom: 2rem;
      animation: slideIn 0.3s ease-out;
      transition: background-color 0.3s, border-color 0.3s;
    }

    html.dark .hadith-card {
      background-color: #1e293b;
      border-color: #334155;
    }

    .hadith-text {
      font-size: 1.125rem;
      line-height: 1.7;
      margin-bottom: 1.5rem;
      color: #111827;
    }

    html.dark .hadith-text {
      color: #f8fafc;
    }

    .hadith-arabic {
      font-family: 'Amiri', serif;
      direction: rtl;
      font-size: 1.25rem;
      line-height: 1.7;
      margin-bottom: 1.5rem;
      text-align: right;
      color: #111827;
    }

    html.dark .hadith-arabic {
      color: #f8fafc;
    }

    .hadith-meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      color: #64748b;
      font-size: 0.875rem;
      border-top: none;
      padding-top: 0;
    }

    .hadith-narrator {
      font-style: italic;
      color: #2563eb;
    }

    html.dark .hadith-narrator {
      color: #3b82f6;
    }

    .hadith-source {
      font-weight: 500;
    }
    
    .tab-content {
      display: none;
    }
    
    .tab-content.active {
      display: block;
    }

    /* City selector styles */
    .city-selector-container {
      display: flex;
      justify-content: center;
      align-items: center;
      margin-bottom: 2rem;
      flex-wrap: wrap;
      gap: 0.5rem;
    }

    .city-selector-label {
      font-size: 0.875rem;
      color: var(--text-muted);
    }

    .city-selector {
      padding: 0.5rem;
      border: 1px solid var(--border-color);
      border-radius: var(--radius);
      background-color: transparent;
      color: var(--text-color);
      font-size: 0.875rem;
      min-width: 200px;
      cursor: pointer;
      transition: border-color 0.2s, box-shadow 0.2s;
    }

    .city-selector:hover {
      border-color: var(--primary-color);
    }

    .city-selector:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 2px var(--primary-light);
    }

    /* Update the page background */
    .page-container {
      background-color: #f8fafc;
    }

    html.dark .page-container {
      background-color: #0f172a;
    }

    body {
      background-color: #f8fafc;
    }

    html.dark body {
      background-color: #0f172a;
    }
  </style>
</head>
<body>
  <!-- Update the navbar to match the screenshots -->
<nav class="navbar">
  <div class="navbar-container">
    <a href="#" class="logo">Prayer Hub</a>
    <div class="nav-links">
      <a href="#" class="nav-link" id="prayer-times-link">Prayer Times</a>
      <a href="#" class="nav-link" id="hadiths-link">Hadiths</a>
      <button class="theme-toggle" id="theme-toggle" aria-label="Toggle theme">
        <svg id="moon-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: block;">
          <path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path>
        </svg>
        <svg id="sun-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
          <circle cx="12" cy="12" r="4"></circle>
          <path d="M12 2v2"></path>
          <path d="M12 20v2"></path>
          <path d="m4.93 4.93 1.41 1.41"></path>
          <path d="m17.66 17.66 1.41 1.41"></path>
          <path d="M2 12h2"></path>
          <path d="M20 12h2"></path>
          <path d="m6.34 17.66-1.41 1.41"></path>
          <path d="m19.07 4.93-1.41 1.41"></path>
        </svg>
      </button>
    </div>
  </div>
</nav>
  
  <!-- Prayer Times Page -->
  <main class="container page-container active" id="prayer-times-page">
    <div class="header">
      <h1>Prayer Hub</h1>
      <p>Consultez les horaires de prière en temps réel</p>
      <div class="location-badge" id="location-badge" style="display: none;">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"></path>
          <circle cx="12" cy="10" r="3"></circle>
        </svg>
        <span id="current-location">Alger</span>
      </div>
    </div>
    
    <div class="date-time">
      <h2 class="date" id="current-date"></h2>
      <div class="time" id="current-time"></div>
    </div>
    
    <div class="date-picker-container">
      <button id="date-picker-button" class="date-picker-button">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <rect width="18" height="18" x="3" y="4" rx="2" ry="2"></rect>
          <line x1="16" x2="16" y1="2" y2="6"></line>
          <line x1="8" x2="8" y1="2" y2="6"></line>
          <line x1="3" x2="21" y1="10" y2="10"></line>
        </svg>
        <span id="selected-date-text">Sélectionner une date</span>
      </button>
      <input type="hidden" id="date-picker-input">
    </div>
    
    <div id="error-container"></div>
    
    <div id="loading-container" class="loading">
      <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M21 12a9 9 0 1 1-6.219-8.56"></path>
      </svg>
    </div>
    
    <div id="prayer-times-container" style="display: none;">
      <div id="islamic-date-container"></div>
      
      <h2 class="section-title">Horaires de prière</h2>
      
      <div class="grid">
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <rect width="18" height="18" x="3" y="4" rx="2" ry="2"></rect>
                <line x1="16" x2="16" y1="2" y2="6"></line>
                <line x1="8" x2="8" y1="2" y2="6"></line>
                <line x1="3" x2="21" y1="10" y2="10"></line>
              </svg>
              Prières quotidiennes
            </h3>
          </div>
          <div class="card-content">
            <div class="prayer-list" id="daily-prayers"></div>
          </div>
        </div>
        
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <rect width="18" height="18" x="3" y="4" rx="2" ry="2"></rect>
                <line x1="16" x2="16" y1="2" y2="6"></line>
                <line x1="8" x2="8" y1="2" y2="6"></line>
                <line x1="3" x2="21" y1="10" y2="10"></line>
              </svg>
              Horaires importants
            </h3>
          </div>
          <div class="card-content">
            <div class="prayer-list" id="other-times"></div>
          </div>
        </div>
      </div>
    </div>
  </main>
  
  <!-- Hadiths Page -->
  <main class="container page-container" id="hadiths-page">
    <div class="hadiths-header">
      <h1>Hadiths</h1>
      <p>Découvrez les hadiths classés par narrateurs</p>
    </div>
    
    <div class="tabs" id="hadith-tabs">
      <button class="tab active" data-tab="bukhari">Bukhari</button>
      <button class="tab" data-tab="muslim">Muslim</button>
      <button class="tab" data-tab="tirmidhi">At-Tirmidhi</button>
      <button class="tab" data-tab="abu-dawud">Abu Dawud</button>
    </div>
    
    <div class="tab-content active" id="bukhari-content">
      <div class="hadith-card">
        <p class="hadith-text">"Les actes ne valent que par leurs intentions. Chacun n'aura que selon son intention. Celui qui a émigré pour Allah et Son Messager, son émigration sera pour Allah et Son Messager. Et celui qui a émigré pour obtenir un bien mondain ou pour épouser une femme, son émigration sera pour ce vers quoi il a émigré."</p>
        <p class="hadith-arabic">إنما الأعمال بالنيات، وإنما لكل امرئ ما نوى. فمن كانت هجرته إلى الله ورسوله فهجرته إلى الله ورسوله، ومن كانت هجرته لدنيا يصيبها أو امرأة ينكحها فهجرته إلى ما هاجر إليه.</p>
        <div class="hadith-meta">
          <span class="hadith-narrator">Rapporté par Omar Ibn Al-Khattab</span>
          <span class="hadith-source">Source: Sahih Al-Bukhari</span>
        </div>
      </div>
      
      <div class="hadith-card">
        <p class="hadith-text">"Le Messager d'Allah a dit : « Le musulman est celui dont les musulmans sont à l'abri de sa langue et de sa main, et l'émigrant est celui qui délaisse ce qu'Allah a interdit. »"</p>
        <p class="hadith-arabic">المسلم من سلم المسلمون من لسانه ويده، والمهاجر من هجر ما نهى الله عنه.</p>
        <div class="hadith-meta">
          <span class="hadith-narrator">Rapporté par Abdullah Ibn Amr</span>
          <span class="hadith-source">Source: Sahih Al-Bukhari</span>
        </div>
      </div>
      
      <div class="hadith-card">
        <p class="hadith-text">"Quiconque croit en Allah et au Jour Dernier, qu'il dise du bien ou qu'il se taise. Quiconque croit en Allah et au Jour Dernier, qu'il honore son voisin. Quiconque croit en Allah et au Jour Dernier, qu'il honore son hôte."</p>
        <p class="hadith-arabic">من كان يؤمن بالله واليوم الآخر فليقل خيرا أو ليصمت، ومن كان يؤمن بالله واليوم الآخر فليكرم جاره، ومن كان يؤمن بالله واليوم الآخر فليكرم ضيفه.</p>
        <div class="hadith-meta">
          <span class="hadith-narrator">Rapporté par Abu Hurayrah</span>
          <span class="hadith-source">Source: Sahih Al-Bukhari</span>
        </div>
      </div>
    </div>
    
    <div class="tab-content" id="muslim-content">
      <div class="hadith-card">
        <p class="hadith-text">"Celui qui appelle à la guidée aura une récompense semblable à celles de ceux qui le suivent, sans que leurs récompenses ne soient diminuées en rien. Et celui qui appelle à l'égarement aura un péché semblable à ceux de ceux qui le suivent, sans que leurs péchés ne soient diminués en rien."</p>
        <p class="hadith-arabic">من دعا إلى هدى كان له من الأجر مثل أجور من تبعه لا ينقص ذلك من أجورهم شيئا، ومن دعا إلى ضلالة كان عليه من الإثم مثل آثام من تبعه لا ينقص ذلك من آثامهم شيئا.</p>
        <div class="hadith-meta">
          <span class="hadith-narrator">Rapporté par Abu Hurayrah</span>
          <span class="hadith-source">Source: Sahih Muslim</span>
        </div>
      </div>
    </div>
    
    <div class="tab-content" id="tirmidhi-content">
      <div class="hadith-card">
        <p class="hadith-text">"La crainte d'Allah et le bon caractère sont les qualités qui font entrer le plus de gens au Paradis."</p>
        <p class="hadith-arabic">أكثر ما يدخل الناس الجنة تقوى الله وحسن الخلق.</p>
        <div class="hadith-meta">
          <span class="hadith-narrator">Rapporté par Abu Hurayrah</span>
          <span class="hadith-source">Source: Sunan At-Tirmidhi</span>
        </div>
      </div>
    </div>
    
    <div class="tab-content" id="abu-dawud-content">
      <div class="hadith-card">
        <p class="hadith-text">"Celui qui aime pour Allah, déteste pour Allah, donne pour Allah et refuse pour Allah, a parachevé sa foi."</p>
        <p class="hadith-arabic">من أحب لله وأبغض لله وأعطى لله ومنع لله فقد استكمل الإيمان.</p>
        <div class="hadith-meta">
          <span class="hadith-narrator">Rapporté par Abu Umamah</span>
          <span class="hadith-source">Source: Sunan Abu Dawud</span>
        </div>
      </div>
    </div>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/fr.js"></script>
  <script>
    // Algeria cities data
    const ALGERIA_CITIES = [
      "Alger", "Oran", "Constantine", "Annaba", "Blida", "Batna", "Djelfa", 
      "Sétif", "Sidi Bel Abbès", "Biskra", "Tébessa", "Tlemcen", "Béchar", 
      "Tiaret", "Béjaïa", "Tizi Ouzou", "Jijel", "Skikda", "Chlef", "Ouargla",
      "Tipaza", "Adrar", "Laghouat", "Médéa", "Mostaganem", "Tindouf", "Ghardaïa"
    ];
    
    // DOM Elements
    const themeToggle = document.getElementById('theme-toggle');
    const moonIcon = document.getElementById('moon-icon');
    const sunIcon = document.getElementById('sun-icon');
    const currentDateElement = document.getElementById('current-date');
    const currentTimeElement = document.getElementById('current-time');
    const locationBadge = document.getElementById('location-badge');
    const currentLocationElement = document.getElementById('current-location');
    const datePickerButton = document.getElementById('date-picker-button');
    const datePickerInput = document.getElementById('date-picker-input');
    const selectedDateText = document.getElementById('selected-date-text');
    const errorContainer = document.getElementById('error-container');
    const loadingContainer = document.getElementById('loading-container');
    const prayerTimesContainer = document.getElementById('prayer-times-container');
    const islamicDateContainer = document.getElementById('islamic-date-container');
    const dailyPrayersContainer = document.getElementById('daily-prayers');
    const otherTimesContainer = document.getElementById('other-times');
    
    // Navigation elements
    const prayerTimesLink = document.getElementById('prayer-times-link');
    const hadithsLink = document.getElementById('hadiths-link');
    const prayerTimesPage = document.getElementById('prayer-times-page');
    const hadithsPage = document.getElementById('hadiths-page');
    
    // Hadiths elements
    const hadithTabs = document.querySelectorAll('.tab');
    const tabContents = document.querySelectorAll('.tab-content');
    
    // State
    let currentLocation = '';
    let selectedDate = new Date();
    let prayerData = null;
    
    // Initialize theme
    function initTheme() {
      const html = document.documentElement;
      const savedTheme = localStorage.getItem('theme');
      const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
      
      if (savedTheme === 'dark' || (!savedTheme && prefersDark)) {
        html.classList.replace('light', 'dark');
        moonIcon.style.display = 'none';
        sunIcon.style.display = 'block';
      }
    }
    
    // Toggle theme
    function toggleTheme() {
      const html = document.documentElement;
      
      if (html.classList.contains('dark')) {
        html.classList.replace('dark', 'light');
        moonIcon.style.display = 'block';
        sunIcon.style.display = 'none';
        localStorage.setItem('theme', 'light');
      } else {
        html.classList.replace('light', 'dark');
        moonIcon.style.display = 'none';
        sunIcon.style.display = 'block';
        localStorage.setItem('theme', 'dark');
      }
      
      // Reinitialize date picker to update theme
      initDatePicker();
    }
    
    // Update date and time
    function updateDateTime() {
      const now = new Date();
      
      // Format date
      const dateOptions = { 
        weekday: 'long', 
        year: 'numeric', 
        month: 'long', 
        day: 'numeric' 
      };
      currentDateElement.textContent = now.toLocaleDateString('fr-FR', dateOptions);
      
      // Format time
      const timeOptions = { 
        hour: '2-digit', 
        minute: '2-digit', 
        second: '2-digit',
        hour12: false
      };
      currentTimeElement.textContent = now.toLocaleTimeString('fr-FR', timeOptions);
    }
    
    // Initialize date picker
    function initDatePicker() {
      if (flatpickr.instances[datePickerInput]) {
        flatpickr.instances[datePickerInput].destroy();
      }
      
      flatpickr(datePickerInput, {
        locale: 'fr',
        dateFormat: 'Y-m-d',
        defaultDate: selectedDate,
        onChange: function(selectedDates, dateStr) {
          selectedDate = selectedDates[0];
          updateSelectedDateText();
          fetchPrayerTimes(currentLocation, selectedDate);
        },
        onOpen: function() {
          // Apply theme to the calendar
          const isDark = document.documentElement.classList.contains('dark');
          const calendar = document.querySelector('.flatpickr-calendar');
          if (calendar) {
            if (isDark) {
              calendar.classList.add('dark');
            } else {
              calendar.classList.remove('dark');
            }
          }
        }
      });
      
      updateSelectedDateText();
    }
    
    // Update selected date text
    function updateSelectedDateText() {
      const options = { 
        year: 'numeric', 
        month: 'long', 
        day: 'numeric' 
      };
      selectedDateText.textContent = selectedDate.toLocaleDateString('fr-FR', options);
    }
    
    // Replace the getUserLocation function with this improved version that includes a fallback mechanism
    function getUserLocation() {
      showLoading();
      
      // Show city selection UI regardless of geolocation status
      createCitySelector();
      
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(
          async (position) => {
            const { latitude, longitude } = position.coords;
            try {
              // Reverse geocoding to get city name
              const response = await fetch(
                `https://nominatim.openstreetmap.org/reverse?format=json&lat=${latitude}&lon=${longitude}&zoom=10`
              );
              
              if (!response.ok) {
                throw new Error("Failed to get location name");
              }
              
              const data = await response.json();
              
              // Try to extract city from address
              let city = data.address?.city || 
                        data.address?.town || 
                        data.address?.village || 
                        "Alger"; // Fallback
              
              // Check if the city is in Algeria, if not default to Alger
              if (!ALGERIA_CITIES.includes(city)) {
                city = "Alger";
              }
              
              currentLocation = city;
              currentLocationElement.textContent = city;
              locationBadge.style.display = 'inline-flex';
              
              // Update the city selector to match the detected city
              const citySelector = document.getElementById('city-selector');
              if (citySelector) {
                citySelector.value = city;
              }
              
              fetchPrayerTimes(city, selectedDate);
            } catch (error) {
              console.error("Error getting location:", error);
              setDefaultLocation();
            }
          },
          (error) => {
            console.error("Geolocation error:", error);
            setDefaultLocation();
          }
        );
      } else {
        setDefaultLocation();
      }
    }

    // Add this new function to create a city selector dropdown
    function createCitySelector() {
      // Check if the city selector already exists
      if (document.getElementById('city-selector-container')) {
        return;
      }
      
      const container = document.createElement('div');
      container.id = 'city-selector-container';
      container.className = 'city-selector-container';
      
      const label = document.createElement('label');
      label.htmlFor = 'city-selector';
      label.textContent = 'Sélectionnez une ville:';
      label.className = 'city-selector-label';
      
      const select = document.createElement('select');
      select.id = 'city-selector';
      select.className = 'city-selector';
      
      // Add options for all Algeria cities
      ALGERIA_CITIES.forEach(city => {
        const option = document.createElement('option');
        option.value = city;
        option.textContent = city;
        select.appendChild(option);
      });
      
      // Set default value
      select.value = currentLocation || 'Alger';
      
      // Add change event listener
      select.addEventListener('change', function() {
        const selectedCity = this.value;
        if (validateCity(selectedCity)) {
          currentLocation = selectedCity;
          currentLocationElement.textContent = selectedCity;
          locationBadge.style.display = 'inline-flex';
          fetchPrayerTimes(selectedCity, selectedDate);
        }
      });
      
      container.appendChild(label);
      container.appendChild(select);
      
      // Add a custom input field to allow users to type a city name
      const customInput = document.createElement('div');
      customInput.className = 'city-selector-container';
      customInput.style.marginTop = '0.5rem';

      const inputField = document.createElement('input');
      inputField.type = 'text';
      inputField.id = 'custom-city-input';
      inputField.className = 'city-selector';
      inputField.placeholder = 'Ou entrez une ville manuellement';

      const submitButton = document.createElement('button');
      submitButton.textContent = 'Rechercher';
      submitButton.className = 'city-submit-button';
      submitButton.style.marginLeft = '0.5rem';
      submitButton.style.padding = '0.5rem 1rem';
      submitButton.style.backgroundColor = 'var(--primary-color)';
      submitButton.style.color = 'white';
      submitButton.style.border = 'none';
      submitButton.style.borderRadius = 'var(--radius)';
      submitButton.style.cursor = 'pointer';

      submitButton.addEventListener('click', function() {
        const cityInput = document.getElementById('custom-city-input').value.trim();
        if (cityInput) {
          if (validateCity(cityInput)) {
            currentLocation = cityInput;
            currentLocationElement.textContent = cityInput;
            locationBadge.style.display = 'inline-flex';
            
            // Update the dropdown to match if the city exists in the list
            const citySelector = document.getElementById('city-selector');
            if (ALGERIA_CITIES.includes(cityInput) && citySelector) {
              citySelector.value = cityInput;
            }
            
            fetchPrayerTimes(cityInput, selectedDate);
          }
        }
      });

      customInput.appendChild(inputField);
      customInput.appendChild(submitButton);
      
      container.parentNode.insertBefore(customInput, container.nextSibling);
      
      // Insert after date picker
      const datePickerContainer = document.querySelector('.date-picker-container');
      datePickerContainer.parentNode.insertBefore(container, datePickerContainer.nextSibling);
    }
    
    // Add this function after the createCitySelector function to validate city input
    function validateCity(city) {
      // Check if the city exists in the ALGERIA_CITIES array
      if (!ALGERIA_CITIES.includes(city)) {
        showError(`"${city}" n'est pas une ville valide en Algérie. Retour à la localisation par défaut.`);
        setDefaultLocation();
        return false;
      }
      return true;
    }
    
    // Set default location
    function setDefaultLocation() {
      currentLocation = "Alger";
      currentLocationElement.textContent = "Alger";
      locationBadge.style.display = 'inline-flex';
      
      // Update city selector if it exists
      const citySelector = document.getElementById('city-selector');
      if (citySelector) {
        citySelector.value = "Alger";
      }
      
      fetchPrayerTimes("Alger", selectedDate);
    }
    
    // Fetch prayer times
    async function fetchPrayerTimes(city, date) {
      showLoading();
      clearError();
      
      try {
        const formattedDate = formatDate(date);
        const country = "Algeria";
        const response = await fetch(
          `https://api.aladhan.com/v1/timingsByCity/${formattedDate}?city=${encodeURIComponent(city)}&country=${encodeURIComponent(country)}&method=8`
        );
        
        if (!response.ok) {
          throw new Error(`HTTP error! Status: ${response.status}`);
        }
        
        const data = await response.json();
        
        if (data.code === 200 && data.status === 'OK') {
          prayerData = data.data;
          displayPrayerTimes(prayerData);
        } else {
          showError(data.status || 'Failed to fetch prayer times');
        }
      } catch (error) {
        showError(error.message || 'Failed to fetch prayer times');
      } finally {
        hideLoading();
      }
    }
    
    // Format date for API
    function formatDate(date) {
      const day = String(date.getDate()).padStart(2, '0');
      const month = String(date.getMonth() + 1).padStart(2, '0');
      const year = date.getFullYear();
      return `${day}-${month}-${year}`;
    }
    
    // Display prayer times
    function displayPrayerTimes(data) {
      const timings = data.timings;
      const date = data.date;
      
      // Display Islamic date
      displayIslamicDate(date);
      
      // Determine next prayer
      const nextPrayer = getNextPrayer(timings);
      
      // Check if it's Ramadan
      const isRamadanMonth = isRamadan(date);
      
      // Display daily prayers
      dailyPrayersContainer.innerHTML = '';
      
      const dailyPrayers = [
        { name: 'Fajr', nameAr: 'الفجر', time: timings.Fajr, key: 'fajr' },
        { name: 'Dhuhr', nameAr: 'الظهر', time: timings.Dhuhr, key: 'dhuhr' },
        { name: 'Asr', nameAr: 'العصر', time: timings.Asr, key: 'asr' },
        { name: 'Maghrib', nameAr: 'المغرب', time: timings.Maghrib, key: 'maghrib' },
        { name: 'Isha', nameAr: 'العشاء', time: timings.Isha, key: 'isha' }
      ];
      
      dailyPrayers.forEach(prayer => {
        const prayerElement = createPrayerItem(
          prayer.name, 
          prayer.nameAr, 
          prayer.time, 
          nextPrayer === prayer.key
        );
        dailyPrayersContainer.appendChild(prayerElement);
      });
      
      // Display other times
      otherTimesContainer.innerHTML = '';
      
      const otherTimes = [
        { name: 'Sunrise', nameAr: 'الشروق', time: timings.Sunrise },
        { name: 'Sunset', nameAr: 'الغروب', time: timings.Sunset }
      ];
      
      // Only add Imsak and Iftar during Ramadan
      if (isRamadanMonth) {
        otherTimes.push(
          { name: 'Imsak', nameAr: 'الإمساك', time: timings.Imsak },
          { name: 'Iftar (Maghrib)', nameAr: 'الإفطار', time: timings.Maghrib }
        );
      }
      
      otherTimes.push({ name: 'Midnight', nameAr: 'منتصف الليل', time: timings.Midnight });
      
      otherTimes.forEach(prayer => {
        const prayerElement = createPrayerItem(prayer.name, prayer.nameAr, prayer.time);
        otherTimesContainer.appendChild(prayerElement);
      });
      
      // Show prayer times container
      prayerTimesContainer.style.display = 'block';
    }
    
    // Create prayer item element
    function createPrayerItem(name, nameAr, time, isNext = false) {
      const prayerItem = document.createElement('div');
      prayerItem.className = `prayer-item${isNext ? ' next' : ''}`;
      
      prayerItem.innerHTML = `
        <div class="prayer-name">
          <span class="prayer-name-en">${name}</span>
          <span class="prayer-name-ar">${nameAr}</span>
        </div>
        <span class="prayer-time">${time || 'N/A'}</span>
      `;
      
      return prayerItem;
    }
    
    // Display Islamic date
    function displayIslamicDate(dateInfo) {
      if (!dateInfo || !dateInfo.hijri) {
        islamicDateContainer.innerHTML = '';
        return;
      }
      
      const hijri = dateInfo.hijri;
      const islamicDate = `${hijri.day} ${hijri.month.ar} ${hijri.year}`;
      
      islamicDateContainer.innerHTML = `
        <div class="islamic-date">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <rect width="18" height="18" x="3" y="4" rx="2" ry="2"></rect>
            <line x1="16" x2="16" y1="2" y2="6"></line>
            <line x1="8" x2="8" y1="2" y2="6"></line>
            <line x1="3" x2="21" y1="10" y2="10"></line>
          </svg>
          <div>
            <span class="font-medium">${dateInfo.gregorian?.date}</span>
            <span class="islamic-date-divider">|</span>
            <span class="font-medium arabic-text">${islamicDate}</span>
          </div>
        </div>
      `;
    }
    
    // Check if it's Ramadan
    function isRamadan(dateInfo) {
      if (!dateInfo || !dateInfo.hijri) return false;
      
      const hijriMonth = dateInfo.hijri.month.number;
      return hijriMonth === 9; // Ramadan is the 9th month in the Hijri calendar
    }
    
    // Get next prayer
    function getNextPrayer(times) {
      if (!times) return null;
      
      const now = new Date();
      const currentHour = now.getHours();
      const currentMinute = now.getMinutes();
      
      const prayers = [
        { name: 'fajr', time: times.Fajr },
        { name: 'dhuhr', time: times.Dhuhr },
        { name: 'asr', time: times.Asr },
        { name: 'maghrib', time: times.Maghrib },
        { name: 'isha', time: times.Isha }
      ];
      
      // Only check for next prayer if viewing today's date
      const today = new Date();
      if (
        selectedDate.getDate() === today.getDate() &&
        selectedDate.getMonth() === today.getMonth() &&
        selectedDate.getFullYear() === today.getFullYear()
      ) {
        for (const prayer of prayers) {
          if (!prayer.time) continue;
          
          const [prayerHour, prayerMinute] = prayer.time.split(':').map(Number);
          
          if (
            prayerHour > currentHour || 
            (prayerHour === currentHour && prayerMinute > currentMinute)
          ) {
            return prayer.name;
          }
        }
      }
      
      return null; // No next prayer for past or future dates
    }
    
    // Show loading
    function showLoading() {
      loadingContainer.style.display = 'flex';
      prayerTimesContainer.style.display = 'none';
    }
    
    // Hide loading
    function hideLoading() {
      loadingContainer.style.display = 'none';
    }
    
    // Show error
    function showError(message) {
      errorContainer.innerHTML = `
        <div class="error-message">
          ${message}
        </div>
      `;
      
      // Automatically clear the error after 5 seconds
      setTimeout(() => {
        clearError();
      }, 5000);
    }
    
    // Clear error
    function clearError() {
      errorContainer.innerHTML = '';
    }
    
    // Switch page
    function switchPage(pageId) {
      document.querySelectorAll('.page-container').forEach(page => {
        page.classList.remove('active');
      });
      
      document.getElementById(pageId).classList.add('active');
      
      document.querySelectorAll('.nav-link').forEach(link => {
        link.classList.remove('active');
      });
      
      if (pageId === 'prayer-times-page') {
        prayerTimesLink.classList.add('active');
      } else if (pageId === 'hadiths-page') {
        hadithsLink.classList.add('active');
      }
      
      // Save the current page to localStorage
      localStorage.setItem('currentPage', pageId);
    }
    
    // Switch hadith tab
    function switchHadithTab(tabId) {
      document.querySelectorAll('.tab').forEach(tab => {
        tab.classList.remove('active');
      });
      
      document.querySelectorAll('.tab-content').forEach(content => {
        content.classList.remove('active');
      });
      
      document.querySelector(`.tab[data-tab="${tabId}"]`).classList.add('active');
      document.getElementById(`${tabId}-content`).classList.add('active');
    }
    
    // Event listeners
    themeToggle.addEventListener('click', toggleTheme);
    
    datePickerButton.addEventListener('click', function() {
      const instance = flatpickr.instances[datePickerInput];
      if (instance) {
        instance.open();
      }
    });
    
    // Navigation event listeners
    prayerTimesLink.addEventListener('click', function(e) {
      e.preventDefault();
      switchPage('prayer-times-page');
    });
    
    hadithsLink.addEventListener('click', function(e) {
      e.preventDefault();
      switchPage('hadiths-page');
    });
    
    // Hadith tabs event listeners
    hadithTabs.forEach(tab => {
      tab.addEventListener('click', function() {
        const tabId = this.getAttribute('data-tab');
        switchHadithTab(tabId);
      });
    });
    
    // Initialize
    document.addEventListener('DOMContentLoaded', function() {
      initTheme();
      initDatePicker();
      updateDateTime();
      setInterval(updateDateTime, 1000);
      
      // Restore the last viewed page if available
      const lastPage = localStorage.getItem('currentPage');
      if (lastPage) {
        switchPage(lastPage);
      } else {
        // Default to prayer times page
        switchPage('prayer-times-page');
      }
      
      getUserLocation();
    });
  </script>
</body>
</html>

